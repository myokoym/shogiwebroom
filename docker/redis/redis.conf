# Redis Configuration for WebChessClock Development
# Optimized for local development environment

# =================================
# Basic Configuration
# =================================
# Allow connections from any IP (for Docker networking)
bind 0.0.0.0

# Default Redis port
port 6379

# Enable protected mode for security
protected-mode yes

# Set a password for Redis (optional for development)
# requirepass your_redis_password

# =================================
# Persistence Configuration
# =================================
# Enable AOF (Append Only File) for durability
appendonly yes
appendfilename "appendonly.aof"

# AOF fsync policy: always, everysec, or no
appendfsync everysec

# Enable RDB snapshots for backup
save 900 1    # Save if at least 1 key changed in 900 seconds
save 300 10   # Save if at least 10 keys changed in 300 seconds
save 60 10000 # Save if at least 10000 keys changed in 60 seconds

# RDB file name
dbfilename dump.rdb

# Working directory for data files
dir /data

# =================================
# Memory Management
# =================================
# Maximum memory limit (256MB for development)
maxmemory 256mb

# Memory eviction policy when maxmemory is reached
maxmemory-policy allkeys-lru

# =================================
# Performance Optimization
# =================================
# TCP listen backlog
tcp-backlog 511

# TCP keepalive
tcp-keepalive 300

# Timeout for idle clients (0 = no timeout)
timeout 0

# =================================
# Logging Configuration
# =================================
# Log level: debug, verbose, notice, warning
loglevel notice

# Log to stdout for Docker container logging
logfile ""

# =================================
# Database Configuration
# =================================
# Number of databases (default: 16)
databases 16

# =================================
# Development Specific Settings
# =================================
# Disable some background operations for faster startup
stop-writes-on-bgsave-error no

# Enable keyspace notifications for debugging
notify-keyspace-events "Ex"

# =================================
# Security Settings for Development
# =================================
# Disable dangerous commands in development
# rename-command FLUSHDB ""
# rename-command FLUSHALL ""
# rename-command DEBUG ""
# rename-command CONFIG ""

# =================================
# Client Configuration
# =================================
# Maximum number of connected clients
maxclients 10000

# =================================
# Slow Log Configuration
# =================================
# Log queries slower than 10 milliseconds
slowlog-log-slower-than 10000

# Keep last 128 slow queries
slowlog-max-len 128